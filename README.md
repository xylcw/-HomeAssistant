#-å®¶åº­åŠ©ç†
åœ¨äº‘æœåŠ¡å™¨ä¸Šé€šè¿‡Dockerå®‰è£…å®¶åº­åŠ©ç†ï¼Œå®ç°é€šè¿‡å¤–ç½‘ç®¡ç†ç±³å®¶è®¾å¤‡ï¼Œå¹¶ä¸”å¯ä»¥æ¥å…¥å…¶ä»–å“ç‰Œè®¾å¤‡
#ğŸŒ€ æ–è®¯M1ç©ºæ°”æ£€æµ‹ä»ªæ¥å…¥HA(äº‘æœåŠ¡å™¨ç‰ˆ)

>ğŸ“Œ**æ ¸å¿ƒç›®æ ‡**ï¼šé€šè¿‡æœ¬æ•™ç¨‹ï¼Œå°†ä½ çš„==æ–è®¯M1ç©ºæ°”æ£€æµ‹ä»ª==æ— ç¼æ¥å…¥**ç±³å®¶**ç”Ÿæ€ç³»ç»Ÿï¼Œå®ç°**è·¨å¹³å°è”åŠ¨**å’Œ**è¯­éŸ³æ§åˆ¶**ï¼

---

##ğŸ“‹  å‰ç½®å‡†å¤‡æ¸…å•
-âœ… æ–è®¯M1ç©ºæ°”æ£€æµ‹ä»ªè®¾å¤‡(åˆ·å…¥äº†å›ºä»¶ç‰ˆæœ¬çš„ï¼Œå³çƒ§å½•è¿‡ï¼Œ[çƒ§å½•æ•™ç¨‹](https://github.com/a2633063/zM1/wiki/%E5%9B%BA%E4%BB%B6%E7%83%A7%E5%BD%95)ï¼‰
-âœ… å®‰å“æ‰‹æœº(iOSç«¯åŠé¸¿è’™ç«¯æš‚æ— ç›¸å…³é€‚é…è½¯ä»¶ï¼‰
-âœ… äº‘æœåŠ¡å™¨(ä½¿ç”¨ç”µè„‘æˆ–è€…å¸¦Linuxç³»ç»Ÿçš„è®¾å¤‡éƒ½è¡Œï¼Œ==å½“å‰æŒ‡å—ä¸ºäº‘æœåŠ¡å™¨ç‰ˆæ•™ç¨‹==ï¼Œå…¶ä»–ç‰ˆæœ¬æ•™ç¨‹è¯·è‡ªè¡Œå¯»æ‰¾ï¼‰
-âœ…  å®‰å“åº”ç”¨[ZControl](https://www.pgyer.com/rGpHakMY)(ç‚¹å‡»ä¸‹è½½)
-âœ…**é‡è¦å·¥å…·**ï¼š[å®¶åº­åŠ©ç†](https://www.home-assistant.io/)ã€mqttæœåŠ¡å™¨ï¼ˆå‡åœ¨äº‘æœåŠ¡å™¨ä¸Šè¿›è¡Œå®‰è£…ï¼Œæ­¤å¤„ä¸ç”¨ç®¡ï¼‰

---
%% æ³¨ï¼šæ£€æµ‹ä»ªè®¾å¤‡éœ€ç”¨æ•°æ®çº¿æŒç»­ä¾›ç”µï¼Œ è¯·åœ¨æ“ä½œå’Œä½¿ç”¨è¿‡ç¨‹ä¸­ä¿æŒé€šç”µ %%
##ğŸ› ï¸  æ¥å…¥æ­¥éª¤è¯¦è§£

###1ï¸Ğ®è®¾å¤‡åˆå§‹åŒ–è¿æ¥WiFi
1.é•¿æŒ‰è®¾å¤‡æŒ‰é’®15ç§’å·¦å³æ¢å¤å‡ºå‚æ¨¡å¼ï¼Œå¼€æœºåï¼Œç”¨æ‰‹æœº/ç”µè„‘è¿æ¥è®¾å¤‡çš„çƒ­ç‚¹ï¼š==ZM1_XXXX==(XXXXä¸ºå”¯ä¸€æ ‡è¯†)ï¼Œè¿æ¥åç”¨æµè§ˆå™¨æ‰“å¼€ï¼šhttpï¼š//192.168.0.1
2. åœ¨æ‰“å¼€çš„é¡µé¢ä¸­å¡«å†™ä½ çš„``WiFiåç§°åŠå¯†ç ``ï¼Œç‚¹ä¸‹ä¸€æ­¥ï¼Œä¼šæ˜¾ç¤ºé…ç½®æˆåŠŸï¼Œè®¾å¤‡è‡ªåŠ¨é‡å¯åè¿æ¥wifi
3.åœ¨==ZControl==çš„å¢åŠ è®¾å¤‡é¡µé¢ä¸­ç‚¹å‡»è·å–å±€åŸŸç½‘è®¾å¤‡æŒ‰é’®.å¹¶ç¡®è®¤è®¾å¤‡åˆ—è¡¨ä¸­å¢åŠ äº†è®¾å¤‡.æ³¨æ„ï¼šæ­¤æ­¥éª¤å¯èƒ½ä¼šé€šä¿¡ä¸ç¨³å®šï¼Œè¯·å¤šè¯•å‡ æ¬¡(å¦‚å›¾1-1)
![[IMG_20250507_085555.jpg]]
#å›¾1-1
**å®Œæˆä»¥ä¸Šæ­¥éª¤åï¼Œå½“zM1è®¾å¤‡åœ¨å±€åŸŸç½‘ä¸‹ï¼Œæ‰‹æœºå·²ç»å¯ä»¥ç›´æ¥æ§åˆ¶zM1è®¾å¤‡äº†.****

---
###2ï¸ä¸ºäº‘æœåŠ¡å™¨å®‰è£…å®å¡”é¢æ¿
  [å®å¡”å®˜ç½‘](https://www.bt.cn/new/download.html)
1.æ‰“å¼€å®å¡”å®˜ç½‘ï¼Œå¤åˆ¶é€šç”¨å®‰è£…è„šæœ¬å‘½ä»¤ï¼Œé€šè¿‡ç»ˆç«¯è¿æ¥æœåŠ¡å™¨ï¼Œå¹¶ç²˜è´´è„šæœ¬ï¼Œç­‰å¾…å®‰è£…å®Œæˆ (å¦‚å›¾2-1)
![[IMG_20250507_111232.jpg]]
#å›¾2-1
2.æ‰“å¼€æ˜¾ç¤ºçš„å¤–ç½‘é¢æ¿é“¾æ¥ï¼Œå¹¶è¾“å…¥è´¦å·å¯†ç ï¼Œç™»å½•åç»‘å®šå®å¡”è´¦å·ï¼Œæ²¡æœ‰å®å¡”è´¦å·å¯ä»¥å…ˆæ³¨å†Œä¸€ä¸ª
3.å®‰è£…é¢æ¿æ¨èé…ç½®ï¼Œç­‰å¾…å®‰è£…å®Œæˆ
4. **å…³é”®æ­¥éª¤**ï¼š
   >â— å®‰è£…Docker
   > åœ¨é¢æ¿å·¦ä¾§èœå•æ ç‚¹å‡»**Docker**ï¼Œç‚¹å‡»å‰å¾€å®‰è£…ï¼Œç­‰å¾…å®‰è£…å®Œæˆ

---
###3ï¸åœ¨Dockeråº”ç”¨å•†åº—å®‰è£…home Assistantä»¥åŠEMQX
1.åœ¨é¢æ¿ä¸­ç‚¹å‡»Dockerâ†’åº”ç”¨æœç´¢ğŸ”ï¼Œè¾“å…¥``å®¶åº­åŠ©ç†``å¹¶å®‰è£… (å¦‚å›¾3-1
![[mmexport 1746585639186.png]]
#å›¾3-1
 
 2. è¾“å…¥``emqx``å¹¶å®‰è£… (å¦‚å›¾3-2)
![[mmexport 1746585641345.png]]
#å›¾3-2

---
###4ï¸âˆå¼€æ”¾æœåŠ¡å™¨ç«¯å£ï¼Œç¡®ä¿å®‰è£…çš„Dockeråº”ç”¨èƒ½å¤Ÿè®¿é—®
1.ç»™æœåŠ¡å™¨çš„==å®‰å…¨ç»„/é˜²ç«å¢™==æ·»åŠ æ–°==è§„åˆ™/ç­–ç•¥==ï¼Œé…ç½®å¦‚ä¸‹:
```
è§„åˆ™æ–¹å‘ï¼šå…¥

åè®®ï¼šè‡ªå®šä¹‰tcp

ç«¯å£èŒƒå›´/ç«¯å£ï¼š18083ã€1883ã€8883ã€8083ã€8084ã€8123 (è¯·åˆ†æ‰¹æ¬¡å¼€æ”¾ç«¯å£ï¼Œä¸€ä¸ªç«¯å£ä¸€ä¸ªç«¯å£æ¥)

æˆæƒipï¼š0.0.0.0/0
```
(å¦‚å›¾4-1ï¼Œ``æ³¨:ä¸åŒæœåŠ¡å™¨ä¾›åº”å•†é¡µé¢ä¸åŒï¼Œæ­¥éª¤å·®ä¸å¤š``)
![[mmexport1746586808245.jpg]]
              #å›¾4-1

---
### 5ï¸âƒ£é…ç½®mqttæœåŠ¡å™¨
1. åœ¨å®å¡”é¢æ¿ä¸­ç‚¹å‡»Dockerâ†’åº”ç”¨å•†åº— â†’å·²å®‰è£…â†’æ‰¾åˆ°==emqxè½¯ä»¶å¡ç‰‡==
2. ç‚¹å‡»è¯¦æƒ…â†’è®°ä½é»˜è®¤è´¦å·å¯†ç 
   (å¦‚å›¾5-1)
![[IMG_20250508_000945.png]]
              #å›¾5-1
3. ç‚¹å‡»å¡ç‰‡ç«¯å£:``18083``ï¼Œå‰å¾€ç™»å½•é¡µé¢ï¼Œè¾“å…¥è´¦å·å¯†ç ç™»å½• (å¦‚å›¾5-2)
![[IMG_20250508_001755.jpg]]
              #å›¾5-2
4. ç™»å½•åä¼šå«ä½ ä¿®æ”¹å¯†ç ï¼Œä¿®æ”¹å®Œæˆåå°±å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥äº†
---
### 6ï¸âƒ£é…ç½®è½¯ä»¶ç«¯ï¼Œä¸Šä¼ æ•°æ®åˆ°mqttæœåŠ¡å™¨
1. æ‰“å¼€==ZControl==APPï¼Œåœ¨ä¾§è¾¹æ ä¸­ç‚¹å‡»è®¾ç½®æŒ‰é’®
2. è¾“å…¥MQTTåœ°å€(``äº‘æœåŠ¡å™¨IP+1883`` )å¦‚:45.15.4.5:1883ã€MQTTç”¨æˆ·å`admin`ã€MQTTç™»å½•å¯†ç (ä½ ä¿®æ”¹è¿‡åçš„)ï¼Œåè¿”å›è®¾å¤‡ç•Œé¢ï¼Œç¡®ä¿åº•éƒ¨æœ‰æç¤ºæœåŠ¡å™¨å·²ç»è¿æ¥ã€‚
3. ç‚¹å‡»å³ä¸Šè§’äº‘å›¾æ ‡ï¼Œappä¼šé€šè¿‡udpå°†MQTTé…ç½®å‘ç»™zM1.å¦‚æœæ­£å¸¸,zM1ä¼šç›´æ¥è¿ä¸ŠMQTTæœåŠ¡å™¨,ç°åœ¨å°±å¯ä»¥é€šè¿‡MQTTæ§åˆ¶è®¾å¤‡äº†.
å¦‚å›¾6-1
![[a2ebd6166cbb4cf42a8756bb66569e4955e011406011ed8ec76131bf43a5b4f7.0.png]]
              #å›¾6-1

---
### 7ï¸âƒ£é…ç½®Home Assistant
1. å…ˆä¸ºHAå®‰è£…å°ç±³å®˜æ–¹æ’ä»¶:
	1. æ‰“å¼€å®å¡”é¢æ¿ï¼Œç‚¹å‡»Dockerï¼Œç‚¹å‡»å®¹å™¨ï¼Œæ‰¾åˆ°æœ‰HAåç§°çš„å®¹å™¨
	2. ç‚¹å‡»å®¹å™¨å³è¾¹çš„ç»ˆç«¯ â†’ ç¡®è®¤ 
	  (å¦‚å›¾7-1)
![[IMG_20250512_190443.png]]
              #å›¾7-1
       3. åˆ†ä¸‰æ¬¡è¾“å…¥ä»¥ä¸‹æŒ‡ä»¤(éš”ä¸€è¡Œä¸ºä¸€æ¬¡)
```
git clone https://github.com/XiaoMi/ha_xiaomi_home.git

cd ha_xiaomi_home

./install.sh /config
```
2. å®Œæˆåé‡å¯å®¹å™¨ (å¦‚å›¾7-2)
![[IMG_20250512_190347.png]]
              #å›¾7-2
3. ç­‰å¾…é‡å¯å®Œåï¼ŒæŒ‰ç…§5ï¸âƒ£-1çš„æ–¹æ³•æ‰¾åˆ°HomeAssistantå¡ç‰‡ï¼Œç‚¹å‡»``ç«¯å£:8123`` å‰å¾€é…ç½®(å¦‚å›¾7-3)
![[clipboard_2025-05-12_18-33.png]]
              #å›¾7-3
4. ç‚¹å‡»åˆ›å»ºæ™ºèƒ½å®¶å±…åè®¾ç½®è´¦å·å¯†ç ã€‚ (å¦‚å›¾7-4)
![[IMG_20250508_004242.jpg]]
              #å›¾7-4
5. ç„¶åä¸€ç›´ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œç›´åˆ°æ˜¾ç¤ºHAä¸»é¡µ (å¦‚å›¾7-5)
![[clipboard_2025-05-12_18-38.png]]
              #å›¾7-5
6. åç‚¹å‡»å·¦ä¸‹è§’è®¾ç½® â†’ è®¾å¤‡ä¸æœåŠ¡ â†’
å³ä¸‹è§’æ·»åŠ é›†æˆ â†’ æœç´¢ ``xiaomi`` é€‰æ‹©ç¬¬äºŒä¸ª==Xiaomi Home==(å¦‚å›¾7-6)
![[clipboard_2025-05-12_19-08.png]]
              #å›¾7-6
7. ç‚¹å‡»åä¸€ç›´ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œå½“å¼¹å‡ºç™»å½•é¡µé¢ï¼Œç‚¹å‡»ç™»å½•/æ³¨å†Œå°ç±³è´¦å·
(å¦‚å›¾7-7)
![[clipboard_2025-05-12_19-11.png]]
              #å›¾7-7

---
### 8ï¸âƒ£é…ç½®HAæ–‡ä»¶(æœ€åä¸€æ­¥!!!)
1. æŒ‰ç…§7ï¸âƒ£-6çš„æ–¹æ³•æ·»åŠ é›†æˆï¼Œæœç´¢mqtt
â†’ é€‰æ‹©ç¬¬ä¸€ä¸ª  (å¦‚å›¾8-1)
![[IMG_20250512_203212.jpg]]
              #å›¾8-1
2. è¾“å…¥==æœåŠ¡å™¨IP==å’Œ==mqttæœåŠ¡å™¨==è´¦å·å’Œå¯†ç ï¼Œå®Œæˆåæäº¤  (å¦‚å›¾8-2)
![[IMG_20250512_203147.png]]
              #å›¾8-2
3. è¿”å›åˆ°å®å¡”é¢æ¿ï¼Œåœ¨Dockerå¡ç‰‡é¡µé¢ç‚¹å‡»HAçš„å®‰è£…ç›®å½• â†’ è¿›å…¥dataç›®å½•  (å¦‚å›¾8-3)
![[IMG_20250512_204250.jpg]]
              #å›¾8-3
4. æ‰¾åˆ°==configuration.yaml==æ–‡ä»¶ï¼Œç‚¹å‡»æ‰“å¼€ï¼Œåœ¨æœ€åé¢æ·»åŠ ä»¥ä¸‹å†…å®¹
```
homeassistant:
    packages: !include_dir_named packages
```
5. æ·»åŠ å®Œæˆåä¿å­˜å¹¶å…³é—­çª—å£ï¼Œåœ¨åŒä¸€ç›®å½•ä¸‹æ·»åŠ ==packages==æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨æ–‡ä»¶å¤¹å†…æ·»åŠ åä¸º==m1.yaml==çš„æ–‡ä»¶        (å¦‚å›¾8-4)
![[IMG_20250512_205123.jpg]]
              #å›¾8-4
6. ğŸ’¡æ–‡ä»¶å†…è¦å¡«å…¥çš„å†…å®¹è§ä¸‹æ–¹é…ç½®æ–‡æ¡£ï¼Œåœ¨å†…å®¹ä¸­ï¼Œéœ€è¦æŠŠ==b0f89323bd29==æ›¿æ¢æˆè‡ªå·±çš„æ£€æµ‹ä»ªè®¾å¤‡çš„MACåœ°å€
7. MACåœ°å€åœ¨==ZControl==è½¯ä»¶å†…å³ä¸Šè§’ç‚¹å‡»ç¬”å›¾æ ‡å³å¯çœ‹åˆ°
8. å®Œæˆåä¿å­˜ï¼Œå¹¶è¿”å›åˆ°å¡ç‰‡é¡µé¢ï¼Œé‡å¯HAåº”ç”¨ã€‚(å¦‚å›¾8-5)
![[clipboard_2025-05-12_20-52.png]]
              #å›¾8-5
é‡å¯å®Œæˆåå³å¯åœ¨[æ‰‹æœºç«¯HA](https://m.downxing.com/az/218015.htm)æˆ–é€šè¿‡è®¿é—®ç½‘å€(æœåŠ¡å™¨IP:8123)æ¥æŸ¥è¯¢å’Œè®¾ç½®æ£€æµ‹ä»ªæ•°æ®ã€‚==è‡³æ­¤æ¥å…¥å·¥ä½œä¹Ÿå°±åœ†æ»¡å®Œæˆå•¦==ï¼

---

## ğŸŒ é…ç½®æ–‡æ¡£(è®°å¾—æ›¿æ¢macåœ°å€)
```
mqtt:

  sensor:

    - name: 'zm1_b0f89323bd29_temperature'

      unique_id: zm1_b0f89323bd29_temperature

#     friendly_name: æ¸©åº¦

      state_topic: 'device/zm1/b0f89323bd29/sensor'

      unit_of_measurement: 'Â°C'

      icon: 'mdi:thermometer'

      value_template: '{{ value_json.temperature }}'

#      availability_topic: "device/zm1/b0f89323bd29/availability"

#      payload_available: 1

#      payload_not_available: 0

    - name: 'zm1_b0f89323bd29_humidity'

      unique_id: zm1_b0f89323bd29_humidity

#     friendly_name: æ¹¿åº¦

      state_topic: 'device/zm1/b0f89323bd29/sensor'

      unit_of_measurement: '%'

      icon: mdi:water-percent

      value_template: '{{ value_json.humidity }}'

#      availability_topic: "device/zm1/b0f89323bd29/availability"

#      payload_available: 1

#      payload_not_available: 0

    - name: 'zm1_b0f89323bd29_pm25'

      unique_id: zm1_b0f89323bd29_pm25

#      availability_topic: "device/zm1/b0f89323bd29/availability"

#      payload_available: 1

#      payload_not_available: 0

#      friendly_name: PM25

      state_topic: 'device/zm1/b0f89323bd29/sensor'

      unit_of_measurement: 'Î¼g/mÂ³'

      icon: mdi:blur

      value_template: '{{ value_json.PM25 }}'

    - name: 'zm1_b0f89323bd29_hcho'

      unique_id: zm1_b0f89323bd29_hcho

#     friendly_name: ç”²é†›

      state_topic: 'device/zm1/b0f89323bd29/sensor'

      unit_of_measurement: 'mg/mÂ³'

      icon: mdi:chemical-weapon

      value_template: '{{ value_json.formaldehyde }}'

#      availability_topic: "device/zm1/b0f89323bd29/availability"

#      payload_available: 1

#      payload_not_available: 0

  light:

      name: zm1_b0f89323bd29_brightness

      unique_id: zm1_b0f89323bd29_brightness

      schema: template

      command_topic: "device/zm1/b0f89323bd29/set"

      state_topic: "device/zm1/b0f89323bd29/state"

      command_on_template: >

        {"mac": "b0f89323bd29"

        {%- if brightness is defined -%}

        , "brightness": {{ ((brightness-1) / 64 )|int +1 }}

        {%- else -%}

        , "brightness": 4

        {%- endif -%}

        }

      command_off_template: '{"mac": "b0f89323bd29", "brightness": 0}'

      state_template: >

        {%- if value_json.brightness == 0 -%}

          off

        {%- else -%}

          on

        {%- endif -%}

      brightness_template: >

        {%- if value_json.brightness is defined -%}

          {{ ( value_json.brightness *64 )|int }}

        {%- endif -%}





homeassistant:

  customize:

    light.zm1_b0f89323bd29_brightness:

      friendly_name: zM1äº®åº¦

    sensor.zm1_b0f89323bd29_temperature:

      friendly_name: zM1æ¸©åº¦

    sensor.zm1_b0f89323bd29_humidity:

      friendly_name: zM1æ¹¿åº¦

    sensor.zm1_b0f89323bd29_pm25:

      friendly_name: zM1 PM2.5

    sensor.zm1_b0f89323bd29_hcho:

      friendly_name: zM1ç”²é†›


```

---

## â“ å¸¸è§é—®é¢˜è§£ç­”ï¼ˆFAQï¼‰

### ğŸ” æ£€æµ‹ä»ªæ— æ³•è¢«è½¯ä»¶å‘ç°ï¼Ÿ
- ç½‘ç»œä¸æ˜¯å¾ˆç¨³å®šå¤šåˆ·æ–°å‡ æ¬¡ï¼Œæˆ–è€…é€€å‡ºè½¯ä»¶é‡è¿›
### ğŸ“¡ æ•°æ®åŒæ­¥å»¶è¿Ÿï¼Ÿ
- ç”±äºmqttæœåŠ¡å™¨è¦å…ˆè·å–è®¾å¤‡æ•°æ®ï¼Œç„¶åå†ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œæœ€åHAä»mqttæœåŠ¡å™¨è®¢é˜…ï¼Œå¯¼è‡´å»¶è¿Ÿä¼šæœ‰ç‚¹å¤§ï¼Œä½œè€…æš‚æ—¶ä¸çŸ¥é“æ€ä¹ˆè§£å†³ï¼Œå¯ä»¥è‡ªè¡Œç ”ç©¶

---

#### ğŸ¯ ç‰ˆæœ¬è¯´æ˜
- æ–‡æ¡£æœ€åæ›´æ–°ï¼š2025å¹´5æœˆ12æ—¥20æ—¶
- æ•™ç¨‹æ–‡æ¡£ç‰ˆæœ¬ï¼š1.0.0

```

ğŸ“ **ä½œè€…æ³¨**ï¼šæœ¬æ•™ç¨‹å®æµ‹åŸºäºå¤§ä½¬éƒ¨åˆ†æ•™ç¨‹ä»¥åŠå°ç±³å®˜æ–¹æ–‡æ¡£ï¼Œé‡åˆ°é—®é¢˜æ¬¢è¿åœ¨3138848070@qq.comé‚®ç®±ç•™è¨€è®¨è®ºï¼
```

# æœ€åé™„ä¸Šæ¥è‡ªdeepseekå’Œä½œè€…çš„ç»“æ™¶: ==ç½‘é¡µç‰ˆm1ç©ºæ°”æ£€æµ‹ä»ªæ•°æ®é¢æ¿==

![[æ£€æµ‹ä»ª 1.html]]
